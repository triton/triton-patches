From ea2095bff8a96e13f504e71a98dd2f5c8c3ae072 Mon Sep 17 00:00:00 2001
From: "William A. Kennington III" <william@wkennington.com>
Date: Mon, 6 Aug 2018 15:44:03 -0700
Subject: [PATCH 8/8] Make fixed-ouput message nicer

---
 src/libstore/build.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/libstore/build.cc b/src/libstore/build.cc
index f00cdd12..a1df0e9f 100644
--- a/src/libstore/build.cc
+++ b/src/libstore/build.cc
@@ -3116,7 +3116,7 @@ void DerivationGoal::registerOutputs()
                 /* Throw an error after registering the path as
                    valid. */
                 delayedException = std::make_exception_ptr(
-                    BuildError("fixed-output derivation produced path '%s' with %s hash '%s' instead of the expected hash '%s'",
+                    BuildError("fixed-output derivation produced path '%s' with invalid hash(%s):\n  Got: %s\n  Expected: %s",
                         dest, printHashType(h.type), printHash16or32(h2), printHash16or32(h)));
 
                 Path actualDest = worker.store.toRealPath(dest);
-- 
2.18.0.597.ga71716f1ad-goog

