From fcb494df8186ebad4b0048ab5b42bf3712db17f4 Mon Sep 17 00:00:00 2001
From: "William A. Kennington III" <william@wkennington.com>
Date: Mon, 6 Aug 2018 10:50:31 -0700
Subject: [PATCH 02/10] Remove hardcoded nixos.org references

---
 src/libstore/download.cc | 5 +----
 src/libstore/globals.hh  | 8 ++++----
 2 files changed, 5 insertions(+), 8 deletions(-)

diff --git a/src/libstore/download.cc b/src/libstore/download.cc
index f44f1836..7b2d8299 100644
--- a/src/libstore/download.cc
+++ b/src/libstore/download.cc
@@ -52,10 +52,7 @@ static GlobalConfig::Register r1(&downloadSettings);
 
 std::string resolveUri(const std::string & uri)
 {
-    if (uri.compare(0, 8, "channel:") == 0)
-        return "https://nixos.org/channels/" + std::string(uri, 8) + "/nixexprs.tar.xz";
-    else
-        return uri;
+    return uri;
 }
 
 struct CurlDownloader : public Downloader
diff --git a/src/libstore/globals.hh b/src/libstore/globals.hh
index 32004358..125184a6 100644
--- a/src/libstore/globals.hh
+++ b/src/libstore/globals.hh
@@ -241,7 +241,7 @@ public:
         "Whether to fail if repeated builds produce different output."};
 
     Setting<Strings> trustedPublicKeys{this,
-        {"cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY="},
+        Strings(),
         "trusted-public-keys",
         "Trusted public keys for secure substitution.",
         {"binary-cache-public-keys"}};
@@ -265,9 +265,9 @@ public:
         "or using hacks like qemu-user."};
 
     Setting<Strings> substituters{this,
-        nixStore == "/nix/store" ? Strings{"https://cache.nixos.org/"} : Strings(),
+        Strings(),
         "substituters",
-        "The URIs of substituters (such as https://cache.nixos.org/).",
+        "The URIs of substituters.",
         {"binary-caches"}};
 
     // FIXME: provide a way to add to option values.
@@ -324,7 +324,7 @@ public:
         "setuid/setgid bits or with file capabilities."};
 #endif
 
-    Setting<Strings> hashedMirrors{this, {"http://tarballs.nixos.org/"}, "hashed-mirrors",
+    Setting<Strings> hashedMirrors{this, Strings(), "hashed-mirrors",
         "A list of servers used by builtins.fetchurl to fetch files by hash."};
 
     Setting<uint64_t> minFree{this, 0, "min-free",
-- 
2.19.0.605.g01d371f741-goog

