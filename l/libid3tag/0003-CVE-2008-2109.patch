From d82bad5ac1c2b6a34146238b8b2f9490c24db623 Mon Sep 17 00:00:00 2001
From: "William A. Kennington III" <wak@google.com>
Date: Wed, 2 Nov 2016 17:39:38 -0700
Subject: [PATCH 3/3] CVE-2008-2109

---
 field.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/field.c b/field.c
index f2ecc0f..24856c6 100644
--- a/field.c
+++ b/field.c
@@ -291,7 +291,7 @@ int id3_field_parse(union id3_field *field, id3_byte_t const **ptr,
 
       end = *ptr + length;
 
-      while (end - *ptr > 0) {
+      while (end - *ptr > 0 && **ptr != '\0') {
 	ucs4 = id3_parse_string(ptr, end - *ptr, *encoding, 0);
 	if (ucs4 == 0)
 	  goto fail;
-- 
2.8.0.rc3.226.g39d4020

